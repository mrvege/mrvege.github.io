<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Mr.Vege&#39;s Zone</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Mr.Vege&apos;s Blog|machine learning|python|java">
<meta property="og:type" content="website">
<meta property="og:title" content="Mr.Vege's Zone">
<meta property="og:url" content="http://mrvege.github.io/index.html">
<meta property="og:site_name" content="Mr.Vege's Zone">
<meta property="og:description" content="Mr.Vege&apos;s Blog|machine learning|python|java">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Mr.Vege's Zone">
<meta name="twitter:description" content="Mr.Vege&apos;s Blog|machine learning|python|java">
  
    <link rel="alternative" href="/atom.xml" title="Mr.Vege&#39;s Zone" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <script src="http://libs.baidu.com/jquery/1.9.0/jquery.js"></script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="">
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Mr.Vege</a></h1>
		</hgroup>

		
		<p class="header-subtitle">machine learning, coding</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/mrvege" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/u/2907568531" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="/#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="http://www.zhihu.com/people/zhugeqingfeng" title="zhihu">zhihu</a>
					        
								<a class="mail" target="_blank" href="/caiminyi312@gmail.com" title="mail">mail</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/github/" style="font-size: NaNpx;">github</a><a href="/tags/phantomjs-selenium-python-crawl/" style="font-size: NaNpx;">phantomjs, selenium, python,crawl</a><a href="/tags/python/" style="font-size: NaNpx;">python</a><a href="/tags/python-socket/" style="font-size: NaNpx;">python, socket</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">我是谁，我从哪里来，我到哪里去？我就是我，是颜色不一样的吃货…</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Mr.Vege</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="">
				<hgroup>
				  <h1 class="header-author">Mr.Vege</h1>
				</hgroup>
			</div>
			
			<p class="header-subtitle">machine learning, coding</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/mrvege" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/u/2907568531" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="/#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="http://www.zhihu.com/people/zhugeqingfeng" title="zhihu">zhihu</a>
			        
						<a class="mail" target="_blank" href="/caiminyi312@gmail.com" title="mail">mail</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-my-gist" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/15/my-gist/" class="article-date">
  	<time datetime="2015-12-15T12:08:26.000Z" itemprop="datePublished">2015-12-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/15/my-gist/">my gist</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>对了， 有时候我的代码并不会放在博客或者git仓库里，简短的代码可能都会直接用gist发布<br>我的gist的地址：<a href="https://gist.github.com/mrvege" target="_blank" rel="external">https://gist.github.com/mrvege</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/github/">github</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="python-selenium, Phantomjs use to crawl paper" class="article article-type-python" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/15/selenium, Phantomjs use to crawl paper/" class="article-date">
  	<time datetime="2015-12-15T11:49:09.000Z" itemprop="datePublished">2015-12-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/15/selenium, Phantomjs use to crawl paper/">selenium, Phantomjs use to crawl paper</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>本意是用scrapy去抓取文件的， 不过pdf下载部分一直搞不定， 只好先找到页面连接， 然后用selenium和phantomjs来模拟浏览器的行为， 采用点击，另存为的方法<br>不得不说， 标准的论文数据库还是对下载做了许多限制的， 比如我点击论文的pdf地址， 后退回原网页，再重新点击pdf地址，也会给出警告，然后转移到请求登录的界面。<br>这里给出一个简单的单页抓取模板， 但是这种方法效率并不高，SSRN数据库加载的很慢。</p>
<h3 id="1-_基本下载模块">1. 基本下载模块</h3><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line"><span class="variable">__author__ =</span> 'dm'</span><br><span class="line"></span><br><span class="line">from selenium <span class="built_in">import</span> webdriver</span><br><span class="line">from selenium.common.exceptions <span class="built_in">import</span> NoSuchElementException</span><br><span class="line"><span class="built_in">import</span> requests</span><br><span class="line">from bs4 <span class="built_in">import</span> BeautifulSoup</span><br><span class="line"><span class="built_in">import</span> time</span><br><span class="line"><span class="built_in">import</span> urllib.request</span><br><span class="line"></span><br><span class="line"><span class="variable">driver =</span> webdriver.PhantomJS()</span><br><span class="line">driver.set_window_size(<span class="number">1120</span>,<span class="number">550</span>)</span><br><span class="line"><span class="variable">paper_url =</span> <span class="string">"http://papers.ssrn.com/sol3/papers.cfm?abstract_id=2702516"</span></span><br><span class="line">driver.get(paper_url)</span><br><span class="line"><span class="comment"># driver.get("http://papers.ssrn.com/sol3/papers.cfm?abstract_id=2703212")</span></span><br><span class="line"><span class="variable">content =</span> driver.page_source</span><br><span class="line"><span class="variable">flag =</span> <span class="number">1</span></span><br><span class="line">try:</span><br><span class="line">	<span class="variable">download_button =</span> driver.find_element_by_id(<span class="string">"openDownloadLink1"</span>)</span><br><span class="line">	time.sleep(<span class="number">2</span>)</span><br><span class="line">	download_button.click()</span><br><span class="line">	<span class="keyword">if</span> <span class="string">"Data_Integrity_Notice"</span> <span class="keyword">in</span> driver.current_url:</span><br><span class="line">		driver.find_element_by_css_selector(<span class="string">"#AnonymousTab &gt; a.deselected &gt; nobr"</span>).click()</span><br><span class="line">		driver.find_element_by_name(<span class="string">"ProcessAnym"</span>).click()</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="variable">pdf_name =</span> paper_url[<span class="number">51</span>:] +<span class="string">".pdf"</span></span><br><span class="line">		urllib.request.urlretrieve(driver.current_url, pdf_name)</span><br><span class="line">except NoSuchElementException as e:</span><br><span class="line">	print(<span class="string">"need buy it"</span>)</span><br><span class="line">	<span class="variable">flag =</span> <span class="number">0</span></span><br><span class="line">	driver.quit()</span><br></pre></td></tr></table></figure>
<h3 id="2-_测试脚本">2. 测试脚本</h3><blockquote>
<p>用selenium直接导出了一个测试脚本， 非常方便， 推荐大家使用。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">from selenium import webdriver</span><br><span class="line">from selenium<span class="class">.webdriver</span><span class="class">.common</span><span class="class">.by</span> import By</span><br><span class="line">from selenium<span class="class">.webdriver</span><span class="class">.common</span><span class="class">.keys</span> import Keys</span><br><span class="line">from selenium<span class="class">.webdriver</span><span class="class">.support</span><span class="class">.ui</span> import Select</span><br><span class="line">from selenium<span class="class">.common</span><span class="class">.exceptions</span> import NoSuchElementException</span><br><span class="line">from selenium<span class="class">.common</span><span class="class">.exceptions</span> import NoAlertPresentException</span><br><span class="line">import unittest, <span class="tag">time</span>, re</span><br><span class="line"></span><br><span class="line">class <span class="function"><span class="title">Test1</span><span class="params">(unittest.TestCase)</span></span>:</span><br><span class="line">    def <span class="function"><span class="title">setUp</span><span class="params">(self)</span></span>:</span><br><span class="line">        self<span class="class">.driver</span> = webdriver.<span class="function"><span class="title">Chrome</span><span class="params">()</span></span></span><br><span class="line">        self<span class="class">.driver</span><span class="class">.implicitly_wait</span>(<span class="number">30</span>)</span><br><span class="line">        self<span class="class">.base_url</span> = <span class="string">"http://papers.ssrn.com/"</span></span><br><span class="line">        self<span class="class">.verificationErrors</span> = []</span><br><span class="line">        self<span class="class">.accept_next_alert</span> = True</span><br><span class="line">    </span><br><span class="line">    def <span class="function"><span class="title">test_1</span><span class="params">(self)</span></span>:</span><br><span class="line">        driver = self<span class="class">.driver</span></span><br><span class="line">        driver.<span class="function"><span class="title">get</span><span class="params">(self.base_url + <span class="string">"/sol3/papers.cfm?abstract_id=2697209&amp;download=yes"</span>)</span></span></span><br><span class="line">        driver.<span class="function"><span class="title">find_element_by_id</span><span class="params">(<span class="string">"openDownloadLink1"</span>)</span></span>.<span class="function"><span class="title">click</span><span class="params">()</span></span></span><br><span class="line">        driver.<span class="function"><span class="title">find_element_by_css_selector</span><span class="params">(<span class="string">"#AnonymousTab &gt; a.deselected &gt; nobr"</span>)</span></span>.<span class="function"><span class="title">click</span><span class="params">()</span></span></span><br><span class="line">        driver.<span class="function"><span class="title">find_element_by_name</span><span class="params">(<span class="string">"ProcessAnym"</span>)</span></span>.<span class="function"><span class="title">click</span><span class="params">()</span></span></span><br><span class="line">    </span><br><span class="line">    def <span class="function"><span class="title">is_element_present</span><span class="params">(self, how, what)</span></span>:</span><br><span class="line">        try: self<span class="class">.driver</span><span class="class">.find_element</span>(by=how, value=what)</span><br><span class="line">        except NoSuchElementException as e: return False</span><br><span class="line">        return True</span><br><span class="line">    </span><br><span class="line">    def <span class="function"><span class="title">is_alert_present</span><span class="params">(self)</span></span>:</span><br><span class="line">        try: self<span class="class">.driver</span><span class="class">.switch_to</span><span class="class">.alert</span>()</span><br><span class="line">        except NoAlertPresentException as  e: return False</span><br><span class="line">        return True</span><br><span class="line">    </span><br><span class="line">    def <span class="function"><span class="title">close_alert_and_get_its_text</span><span class="params">(self)</span></span>:</span><br><span class="line">        try:</span><br><span class="line">            alert = self<span class="class">.driver</span><span class="class">.switch_to</span><span class="class">.alert</span>()</span><br><span class="line">            alert_text = alert<span class="class">.text</span></span><br><span class="line">            <span class="keyword">if</span> self<span class="class">.accept_next_alert</span>:</span><br><span class="line">                alert.<span class="function"><span class="title">accept</span><span class="params">()</span></span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                alert.<span class="function"><span class="title">dismiss</span><span class="params">()</span></span></span><br><span class="line">            return alert_text</span><br><span class="line">        finally: self<span class="class">.accept_next_alert</span> = True</span><br><span class="line">    </span><br><span class="line">    def <span class="function"><span class="title">tearDown</span><span class="params">(self)</span></span>:</span><br><span class="line">        self<span class="class">.driver</span><span class="class">.quit</span>()</span><br><span class="line">        self.<span class="function"><span class="title">assertEqual</span><span class="params">([], self.verificationErrors)</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    unittest.<span class="function"><span class="title">main</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="3-_PhantomJS以及firefox设置代理">3. PhantomJS以及firefox设置代理</h3><p>需要在配置文件中加入以下内容</p>
<p>3.1  PhantomJS<br><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">service_args =</span> [</span><br><span class="line">	'<span class="variable">--proxy=</span><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">1080</span>' ,</span><br><span class="line">	'<span class="variable">--proxy-type=</span>socks5' ,</span><br><span class="line">]</span><br><span class="line"><span class="variable">driver =</span> webdriver.PhantomJS(<span class="variable">service_args=</span> service_args)</span><br></pre></td></tr></table></figure></p>
<p>3.2  Firefox</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">profile = webdriver.<span class="function"><span class="title">FirefoxProfile</span><span class="params">()</span></span></span><br><span class="line">profile.<span class="function"><span class="title">set_preference</span><span class="params">(<span class="string">'network.proxy.type'</span>, <span class="number">1</span>)</span></span>   #默认值<span class="number">0</span>，就是直接连接；<span class="number">1</span>就是手工配置代理。</span><br><span class="line">profile.<span class="function"><span class="title">set_preference</span><span class="params">(<span class="string">'network.proxy.socks'</span>, proxyip)</span></span> #proxyip需自定义， 我用的是本地的代理<span class="string">"127.0.0.1"</span></span><br><span class="line">profile.<span class="function"><span class="title">set_preference</span><span class="params">(<span class="string">'network.proxy.socks_port'</span>, port)</span></span> #port自定义</span><br><span class="line">profile.<span class="function"><span class="title">set_preference</span><span class="params">(<span class="string">'network.proxy.ssl'</span>,ip)</span></span></span><br><span class="line">profile.<span class="function"><span class="title">set_preference</span><span class="params">(<span class="string">'network.proxy.ssl_port'</span>, port)</span></span></span><br><span class="line">profile.<span class="function"><span class="title">update_preferences</span><span class="params">()</span></span></span><br><span class="line">browser = webdriver.<span class="function"><span class="title">Firefox</span><span class="params">(profile)</span></span></span><br></pre></td></tr></table></figure>
<hr>

      
    </div>
    
    <div class="article-info article-info-index">
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/phantomjs-selenium-python-crawl/">phantomjs, selenium, python,crawl</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-使用Spark分析author—keyword数据集" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/10/使用Spark分析author—keyword数据集/" class="article-date">
  	<time datetime="2015-12-10T07:05:53.000Z" itemprop="datePublished">2015-12-10</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="使用Spark分析author—keyword数据集">使用Spark分析author—keyword数据集</h1><blockquote>
<p>数据集来自唐杰Aminer dataset中自2006-2011中抽取的DM顶级会议的paper, 其中user为paper author, 而item 为出现在paper中的keyword</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">dataset = sc.textFile(<span class="string">"hdfs:///dm/author_keyword/author_keyword.txt"</span>)</span><br><span class="line">user_fields = dataset.map(<span class="keyword">lambda</span> line: line.split(<span class="string">" "</span>))</span><br><span class="line"><span class="comment"># dataset </span></span><br><span class="line">num_users = user_fields.map(<span class="keyword">lambda</span> fields: fields[<span class="number">0</span>]).distinct().count()</span><br><span class="line"><span class="comment"># num_users： 27130</span></span><br><span class="line">num_keywords = user_fields.map(<span class="keyword">lambda</span> field: field[<span class="number">1</span>]).distinct().count()</span><br><span class="line"><span class="comment"># num_keywords： 13543</span></span><br><span class="line">num_ratings = user_fields.map(<span class="keyword">lambda</span> field: field[<span class="number">2</span>]).distinct().count()</span><br><span class="line"><span class="comment">#num_ratings: 30</span></span><br><span class="line">ratings = user_fields.map(<span class="keyword">lambda</span> field: int(field[<span class="number">2</span>]))</span><br><span class="line">max_rating = ratings.reduce(<span class="keyword">lambda</span> x,y : max(x, y))</span><br><span class="line">min_rating = ratings.reduce(<span class="keyword">lambda</span> x,y : min(x, y))</span><br><span class="line"><span class="comment">#max : 52  min:1</span></span><br><span class="line">num_ratings = user_fields.count()</span><br><span class="line"><span class="comment"># num_ratings: 703320 总记录条数</span></span><br><span class="line">mean_rating = ratings.reduce(<span class="keyword">lambda</span> x,y: x+y) *<span class="number">1.0</span> / num_ratings</span><br><span class="line"><span class="comment">#mean_rating： 1.113</span></span><br><span class="line">ratings_per_user = num_ratings / num_users</span><br><span class="line"><span class="comment"># ratings_per_user： 25   平均每个用户和25条记录有关</span></span><br><span class="line">median_rating = np.median(ratings.collect())</span><br><span class="line"><span class="comment">#median_rating ： 1.0  rating的中位数为1</span></span><br><span class="line">ratings_per_keyword = num_ratings / num_keywords</span><br><span class="line"><span class="comment">#ratings_per_keyword： 51</span></span><br><span class="line">ratings.stats()</span><br><span class="line"><span class="comment">#  (count: 703320, mean: 1.11235852812, stdev: 0.529708031287, max: 52.0, min: 1.0)</span></span><br><span class="line">count_by_rating = ratings.countByValue()</span><br><span class="line"><span class="comment"># &#123;1: 650410, 2: 39472, 3: 7984, 4: 2731, 5: 1178, 6: 629, 7: 363, 8: 193, 9: 103, 10: 80, 11: 48, 12: 27, 13: 21, 14: 18, 15: 12, 16: 12, 17: 10, 18: 3, 19: 6, 20: 4, 21: 3, 22: 2, 24: 1, 27: 1, 29: 3, 30: 1, 33: 2, 34: 1, 44: 1, 52: 1&#125;</span></span><br><span class="line"><span class="comment">#绘图</span></span><br><span class="line">x_axis = np.array(count_by_rating.keys())</span><br><span class="line">y_axis = np.array([float(c) <span class="keyword">for</span> c <span class="keyword">in</span> count_by_rating.values()])</span><br><span class="line">y_axis_normed = y_axis / y_axis.sum()</span><br><span class="line">pos = np.arange(len(x_axis))</span><br><span class="line">width =<span class="number">1.0</span></span><br><span class="line">ax = plt.axes()</span><br><span class="line">ax.set_xticks(pos +(width /<span class="number">2</span>))</span><br><span class="line">ax.set_xticklabels(x_axis)</span><br><span class="line">plt.bar(pos, y_axis_normed, width, color=<span class="string">'lightblue'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">user_rating_grouped = user_fields.map(<span class="keyword">lambda</span> fields:(int(fields[<span class="number">0</span>]), int (fields[<span class="number">2</span>]))).groupByKey()</span><br><span class="line"><span class="comment">#user_rating_grouped: PythonRDD[58] at RDD at PythonRDD.scala:43</span></span><br><span class="line">user_ratings_byuser = user_ratings_grouped.map(<span class="keyword">lambda</span> (k, v): (k, len(v)))</span><br><span class="line">user_ratings_byuser_local = user_ratings_byuser.map(<span class="keyword">lambda</span> (k, v): v).collect()</span><br><span class="line"><span class="comment">#各author rating次数直方图</span></span><br><span class="line">hist(user_ratings_byuser_local, bins=<span class="number">200</span>, color=<span class="string">'lightblue'</span>, normed=<span class="keyword">True</span>)</span><br><span class="line">fig = matplotlib.pyplot.gcf()</span><br><span class="line">fig.set_size_inches(<span class="number">16</span>,<span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://lh3.googleusercontent.com/TBlkwczo_FIsPvbLmo6VK8KvLkqWrOobqDVO5LfvaCE=s0" alt="rating分布" title="11.png"><br><img src="https://lh3.googleusercontent.com/m25dQxcVzeiCChM6NRgPpeknrlS-GYO-41GBzp5XMpA=s0" alt="author rating次数分布直方图"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-Spark聚类" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/18/Spark聚类/" class="article-date">
  	<time datetime="2015-11-18T13:36:39.000Z" itemprop="datePublished">2015-11-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="聚类概述以及在Spark中运行Kmeans聚类">聚类概述以及在Spark中运行Kmeans聚类</h3><p>最近在做model的前期工作，聚类， 因为聚类结果要用于下一步的推荐模型当中，所以学习了一下几种常见的聚类算法。这里只写下三种，一种是最简单的Kmeans聚类算法， 另一种是层次聚类算法， 最后一种则算是两种算法的结合，二分K均值聚类。</p>
<ol>
<li><p>Kmeans聚类<br>machine learning的主要问题可以分为分类以及聚类问题。 分类是有监督的学习， 而聚类是没有监督的学习， 换而言之， 分类问题是训练一个有类标的训练集，进而对测试集进行预测， 而聚类问题没有类标，我们只需要知道如何计算相似度就可以了，所以通常情况下clustering是不需要使用训练数据进行学习的。组内的相似性越好， 组间差别越大， 那么聚类就越好。<br>Kmeans是一个非常经典的简单算法，也算得上是最简单的一种。以下为一个简单的例子。来源于维基百科：<a href="https://en.wikipedia.org/wiki/K-means_clustering" target="_blank" rel="external">K-means_clustering</a><br><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/K_Means_Example_Step_1.svg/124px-K_Means_Example_Step_1.svg.png" alt="K initial means" title="step1"></p>
<ol>
<li>k initial “means” (in this case k=3) are randomly generated within the data domain (shown in color).<br><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/K_Means_Example_Step_2.svg/139px-K_Means_Example_Step_2.svg.png" alt="k clusters created" title="step2"></li>
<li>k clusters are created by associating every observation with the nearest mean. The partitions here represent the Voronoi diagram generated by the means.<br><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/K_Means_Example_Step_3.svg/139px-K_Means_Example_Step_3.svg.png" alt="new mean" title="step3"></li>
<li>The centroid of each of the k clusters becomes the new mean.<br><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d2/K_Means_Example_Step_4.svg/139px-K_Means_Example_Step_4.svg.png" alt="clusters finished" title="step 4"></li>
<li><p>Steps 2 and 3 are repeated until convergence has been reached.</p>
<p><strong>算法</strong></p>
</li>
<li>选择K个点作为初始质心</li>
<li><strong>repeat</strong></li>
<li>将每个点指派到最近的质心</li>
<li>重新计算每个簇的质心</li>
<li><p><strong>until</strong> 质心不发生变化     </p>
<p><strong>关于求簇中心的方法,常用的有欧拉距离和cosine：</strong></p>
</li>
<li>欧拉距离<br>$$d<em>{ij}=\sqrt{\sum</em>{k=1}^n(x<em>{ik} - x</em>{jk})^2}$$</li>
<li>cosine（用于document中用于计算相似度）<br><strong>目标函数</strong><br>通常情况采用的都是SSE（summary of the Squared Error）作为度量聚类质量的目标函数<br>也就是满足下面这个式子<br>$$arg min<em>S \sum</em>{i=1}^k \sum_{x\in S_i}|| x- \it\mu_i||^2$$<br>其中$\mu_i$是每个簇所有点的均值， 也就是质心。<blockquote>
<p>关于选定K个中心点的初值，通常是针对具体问题有一些启发式的选取方法，或者随机选取然后跑多次取最好的一个结果。</p>
</blockquote>
</li>
</ol>
</li>
<li><p><strong>run kmeans on spark</strong><br>spark社区越来越活跃， 最近也一直在学习spark， 感觉看别人写的example都非常一目了然， 而自己写的时候就是一头包。<br>其实spark中给出了一些已有的机器学习算法的实现方式，简单的贴一个用spark跑Kmeans的实例代码.</p>
<ol>
<li><p>引入SparkConf以及Kmeans方法</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.mllib.clustering.<span class="type">KMeans</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.mllib.linalg.<span class="type">Vectors</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置具体参数以及解析数据并缓存（因为数据挺大的， 有170W用户，为了便于使用包括数据源以及聚类数目，迭代次数全部采用参数形式从命令行中读取）</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">val</span> <span class="title">sparkConf</span> =</span> <span class="keyword">new</span> <span class="type">SparkConf</span>().setAppName(<span class="string">"KmeansAuthors"</span>).setMaster(<span class="string">"local[4]"</span>)</span><br><span class="line"><span class="function"><span class="keyword">val</span> <span class="title">sc</span> =</span> <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"><span class="comment">// 从hdfs上读取数据</span></span><br><span class="line"><span class="comment">//  val data = sc.textFile("hdfs://localhost:9000/input/feature_1109_2.csv")</span></span><br><span class="line"><span class="function"><span class="keyword">val</span> <span class="title">data</span> =</span> sc.textFile(args(<span class="number">0</span>))</span><br><span class="line"><span class="function"><span class="keyword">val</span> <span class="title">parsedData</span> =</span> data.map(s =&gt; <span class="type">Vectors</span>.dense(s.split(',').map(_.toDouble))).cache()</span><br><span class="line"><span class="comment">// Cluster the data into two classes using KMeans</span></span><br><span class="line"><span class="function"><span class="keyword">val</span> <span class="title">numClusters</span> =</span> args(<span class="number">1</span>).toInt</span><br><span class="line"><span class="function"><span class="keyword">val</span> <span class="title">numIterations</span> =</span> args(<span class="number">2</span>).toInt</span><br><span class="line"><span class="function"><span class="keyword">val</span> <span class="title">clusters</span> =</span> <span class="type">KMeans</span>.train(parsedData, numClusters, numIterations)</span><br></pre></td></tr></table></figure>
</li>
<li><p>聚类并评估结果</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">val</span> <span class="title">clusterCenters</span> =</span> clusters.clusterCenters</span><br><span class="line"><span class="function"><span class="keyword">val</span> <span class="title">labels</span> =</span> clusters.predict(parsedData)</span><br><span class="line">labels.saveAsTextFile(args(<span class="number">3</span>))</span><br><span class="line"><span class="function"><span class="keyword">val</span> <span class="title">WSSSE</span> =</span> clusters.computeCost(parsedData)</span><br><span class="line">println(<span class="string">"Within Set Sum of Squared Errors = "</span> + <span class="type">WSSSE</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>完整代码见我的github中：<a href="https://github.com/mrvege/KmeansExample/blob/master/src/main/scala/KmeansExample.scala" target="_blank" rel="external">KmeansExample</a><br>之后打包成jar包提交到spark集群即可。<br>贴一下我的提交命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./spark-submit --master spark://sparkmaster:<span class="number">7077</span> --class KmeansExample --driver-memory <span class="number">4</span>g --executor-memory <span class="number">8</span>g /home/open/KmeansExample/out/artifacts/KmeansExample_jar/KmeansExample.jar hdfs://localhost:<span class="number">9000</span>/input/feature_1109_2.csv <span class="number">10</span> <span class="number">2000</span> hdfs://localhost:<span class="number">9000</span>/input/kmeansResult2</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>层次聚类<br>与Kmeans不同，层次聚类得到的结果是一棵树， 可以在任意的地方切一刀进而得到想要的结果， 用在模型中也是因为不想和评审们解释太多。有两种产生层次聚类的基本方法：</p>
<ol>
<li>自顶向下<br>从包含所有点的某个簇开始， 每一步分裂一个簇， 直至剩下单点簇， 在这种情况下， 我们需要决定每一步分裂哪一个簇， 以及如何分裂。</li>
<li>自底向上，从点作为个体簇开始，每一步合并最近的簇。因此需要定义簇的邻近性概念。<br>对于自底向上方法来说，那么其实最主要的是一个问题， 如何计算两个簇之间的距离？<br>通常有三个做法：</li>
<li>MAX<blockquote>
<p>不同簇最远的两个点的距离定义为这两个簇的距离</p>
</blockquote>
</li>
<li>MIN<blockquote>
<p>不同簇最近的两个点的距离定义为这两个簇的距离</p>
</blockquote>
</li>
<li>Average<blockquote>
<p>所有点对的平均距离</p>
</blockquote>
</li>
</ol>
</li>
<li><p>二分k均值（bisecting k-means）算法<br>二分k均值（bisecting k-means）算法的主要思想是：首先将所有点作为一个簇，然后将该簇一分为二。之后选择能最大程度降低聚类代价函数（也就是误差平方和）的簇划分为两个簇。以此进行下去，直到簇的数目等于用户给定的数目k为止。<br>原理很简单。这里也不再赘述了。考虑再三，准备把这个算法用到自己的model里来进行聚类。<br>这里有一个spark库， <a href="https://github.com/yu-iskw/bisecting-kmeans" target="_blank" rel="external">bisecting Kmeans</a><br>我forked到了本地准备进一步尝试， 如无意外，稍后会给出应用的方法。</p>
</li>
</ol>
<ol>
<li>参考文章：<br><a href="http://blog.pluskid.org/?p=17" target="_blank" rel="external">1. 漫谈 Clustering (1): k-means</a><br><a href="http://www.cnblogs.com/jerrylead/archive/2011/04/06/2006910.html" target="_blank" rel="external">2. K-means聚类算法</a> </li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="python-socket编程" class="article article-type-python" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/04/06/socket编程/" class="article-date">
  	<time datetime="2015-04-06T11:49:09.000Z" itemprop="datePublished">2015-04-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/06/socket编程/">socket编程</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="socket是什么">socket是什么</h3><ol>
<li>首先,我们要知道网络中进程是如何通信的，在TCP/IP协议簇中，网络层的IP地址可以标识一台计算机在网络中的地址，而传输层的”协议+端口”则能够唯一的标识主机中的应用程序(进程)。这样(ip address, protocol, port)就可以标识出网络的进程了。</li>
<li>现行TCP/IP体系结构比较简单，只有四层，即 应用层，传输层，网际层，网络接口层。<br>|应用层|HTTP, …，SMTP，DNS…RTP|<br>|:—-|:————:|<br>|运输层|TCP,   UDP|<br>|网际层| IP协议|<br>|网络接口层|网络接口1…n|<br>即下图所示<br><img src="http://images.cnblogs.com/cnblogs_com/goodcandle/socket1.jpg" alt="TCP/IP协议簇之间的关系"><br>但是在这当中，我们并没有看到socket在哪里，事实上，socket是应用层与TCP/IP协议族通信的中间软件抽象层，它是一组接口。<br><img src="http://images.cnblogs.com/cnblogs_com/goodcandle/socket2.jpg" alt="Socket抽象层"></li>
</ol>
<h4 id="客户端">客户端</h4><ul>
<li>创建socket连接<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import socket</span><br><span class="line">s = socker.<span class="function"><span class="title">socket</span><span class="params">(socket.AF_INET, socket.SOCK_STREAM)</span></span></span><br><span class="line">#<span class="function"><span class="title">socket</span><span class="params">(family,type[,protocal])</span></span> 使用给定的地址族、套接字类型、协议编号（默认为<span class="number">0</span>）来创建套接字。</span><br><span class="line">#family：AF_INET（用于 Internet 进程间通信） 或者 AF_UNIX（用于同一台机器进程间通信）</span><br><span class="line"><span class="id">#type</span>: SOCKET_STREAM（流式套接字，主要用于 TCP 协议）或者SOCKET_DGRAM（数据报套接字，主要用于 UDP 协议）</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>如果创建socker失败，会抛出一个socket.error的异常，必须进行处理<br><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import <span class="keyword">socket</span>   <span class="comment">#for sockets</span></span><br><span class="line">import sys  <span class="comment">#for exit</span></span><br><span class="line"> </span><br><span class="line">try:</span><br><span class="line">    <span class="comment">#create an AF_INET, STREAM socket (TCP)</span></span><br><span class="line">    <span class="keyword">s</span> = <span class="keyword">socket</span>.<span class="keyword">socket</span>(<span class="keyword">socket</span>.AF_INET, <span class="keyword">socket</span>.SOCK_STREAM)</span><br><span class="line">except <span class="keyword">socket</span>.error, msg:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">' 创建socket错误，错误码:'</span> + str(msg[<span class="number">0</span>]) + <span class="string">' , 错误原因: '</span> + msg[<span class="number">1</span>]</span><br><span class="line">    sys.<span class="keyword">exit</span>();</span><br><span class="line"> </span><br><span class="line"><span class="keyword">print</span> <span class="string">'socket建立成功 ^_^'</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>连接服务器<br>连接服务器时需要知道其IP地址以及端口号<br>这里以github为例</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">host = <span class="string">'www.github.com'</span></span><br><span class="line">port = <span class="number">80</span></span><br><span class="line">sip = socket.<span class="function"><span class="title">gethostbyname</span><span class="params">(host)</span></span></span><br><span class="line">s.<span class="function"><span class="title">connect</span><span class="params">((sip, port)</span></span>)</span><br><span class="line">print <span class="string">'socket 连接到：,'</span> + host +<span class="string">'的IP地址为：'</span> + sip </span><br><span class="line"><span class="id">#Socket</span> Connected to www<span class="class">.github</span><span class="class">.com</span> on ip <span class="number">192.30</span>.<span class="number">252.130</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>发送消息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#请求网页内容</span></span><br><span class="line">message = <span class="string">"GET / HTTP/1.1\r\n\r\n"</span></span><br><span class="line">s.sendall(message)</span><br><span class="line"></span><br><span class="line"><span class="comment">#sendall(data[, flags]) -- send all data</span></span><br><span class="line"><span class="comment">#send(data[, flags]) -- send data, may not send all of it</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>接收消息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span><br><span class="line">recv(buflen[, flags]) -- receive data</span><br><span class="line"> |  recv_into(buffer[, nbytes[, flags]]) -- receive data (into a buffer)</span><br><span class="line"> |  recvfrom(buflen[, flags]) -- receive data and sender's address</span><br><span class="line"> |  recvfrom_into(buffer[, nbytes, [, flags])</span><br><span class="line"> |    -- receive data and sender's address (into a buffer)</span><br><span class="line"> '''</span></span><br><span class="line">reply = s.recv(<span class="number">4096</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>关闭socket连接<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s.<span class="function"><span class="title">close</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h4 id="服务器端">服务器端</h4><ul>
<li><p>打开socket<br>略</p>
</li>
<li><p>绑定socket</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">HOST = <span class="string">''</span>   <span class="comment"># Symbolic name meaning all available interfaces</span></span><br><span class="line">PORT = <span class="number">8888</span> <span class="comment"># Arbitrary non-privileged port</span></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'Socket created'</span></span><br><span class="line">s.bind((HOST, PORT))</span><br><span class="line"><span class="keyword">print</span> <span class="string">'Socket bind complete'</span></span><br><span class="line">``` </span><br><span class="line">- 监听连接</span><br><span class="line">```python</span><br><span class="line"><span class="comment"># listen(n) -- start listening for incoming connections</span></span><br><span class="line">s.listen(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>接收连接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#accept() -- accept a connection, returning new socket and client address</span></span><br><span class="line">conn, addr = s.accept()</span><br><span class="line"><span class="keyword">print</span> <span class="string">'Connected with '</span> + addr[<span class="number">0</span>] + <span class="string">':'</span> + str(addr[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="参考文献：">参考文献：</h4><p><a href="http://www.ibm.com/developerworks/cn/education/linux/l-sock/l-sock.html#icomments" target="_blank" rel="external">1. Linux socket 编程，第一部分</a><br><a href="http://www.cnblogs.com/skynet/archive/2010/12/12/1903949.html" target="_blank" rel="external">2.Linux Socket编程(不限Linux)</a><br><a href="http://yangrong.blog.51cto.com/6945369/1339593" target="_blank" rel="external">3.python socket编程详细介绍</a><br><a href="https://docs.python.org/2/library/socket.html" target="_blank" rel="external">4.socket library </a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python-socket/">python, socket</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-perceptron" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/03/22/perceptron/" class="article-date">
  	<time datetime="2015-03-22T03:28:58.000Z" itemprop="datePublished">2015-03-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/03/22/perceptron/">perceptron</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>相关原理就不再介绍了， 代码贴一下：<br>这里解决的是李航统计学习方法书上2.1的习题<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-&#10;import numpy as np&#10; &#10;training_set = np.array([[(3, 3), 1], [(4, 3), 1], [(1, 1), -1]])&#10;w = np.zeros(2, dtype=int)&#10;b = 0&#10;&#10;def update(item):&#10;    global w, b&#10;    w[0] += 1 * item[1] * item[0][0]&#10;    w[1] += 1 * item[1] * item[0][1]&#10;    b += 1 * item[1]&#10;    print w, b&#10;&#10;def cal(item):&#10;    res = 0&#10;    for i in range(len(item[0])):&#10;        res += item[0][i] * w[i]&#10;    res += b&#10;    res *= item[1]&#10;    return res&#10;&#10;def check():&#10;    flag = 0&#10;    for item in training_set:&#10;        if cal(item) &#60;= 0:&#10;            flag = 1&#10;            update(item)&#10;    if not flag:&#10;        print &#34;RESULT: w: &#34; + str(w) + &#34; b: &#34; + str(b)&#10;    return flag&#10;&#10;if __name__ == &#34;__main__&#34;:&#10;    for i in range(1000):&#10;        if not check(): break</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/machine-learning-coding/">machine learning, coding</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/03/21/hello-world/" class="article-date">
  	<time datetime="2015-03-21T09:03:40.000Z" itemprop="datePublished">2015-03-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/03/21/hello-world/">Hello World</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick_Start">Quick Start</h2><h3 id="Create_a_new_post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run_server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate_static_files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy_to_remote_sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 Mr.Vege
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/mobile.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>





<! -- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



  </div>
</body>
</html>